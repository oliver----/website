<!DOCTYPE html><html><head>
    <title>A feature list for Stencila Sheets : Stencila</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="/img/favicon.png">
    
  
    <link rel="stylesheet" href="/css/materia.min.css">
    <link rel="stylesheet" href="/css/docsearch.min.css">
    <link rel="stylesheet" href="/css/website.css">
    
  <style type="text/css">
    article {
      margin-bottom: 5em;
      padding-bottom: 2em;
      border-bottom: 1px solid #EEE;
    }
    article.content img {
      display: block;
      width: 90%;
      margin: 0 auto;
    }
    #suggested {
      color: #777;
    }
    #discourse-comments {
      margin-top: 4em;
    }
  </style>
  <link rel="stylesheet" href="/css/prism.css">

  </head>
  <body>
    <header class="header">
  <nav class="navbar" role="navigation" aria-label="main navigation">
    <div class="container">
      <div class="navbar-brand">
        <a class="navbar-item" href="/"><img src="/img/logo-name.png" alt="Stencila"></a>
        <div class="navbar-burger"><span></span><span></span><span></span></div>
      </div>
      <div class="navbar-menu">
        <div class="navbar-start">
          <a class="navbar-item" href="/use">Use</a>
          <a class="navbar-item" href="/learn/getting-started/intro.html">Learn</a>
          <a class="navbar-item" href="/contribute">Contribute</a>
        </div>
        <div class="navbar-end">
          <!--
          Search temporarily disabled. See issue #2
          <div class="navbar-item">
            <div class="field">
              <p class="control">
                <input id="search" class="input" type="search" placeholder="Search">
              </p>
            </div>
          </div>
          -->
          <a class="navbar-item" href="/community">Community</a>
          <a class="navbar-item" href="/blog">Blog</a>
        </div>
      </div>
    </div>
  </nav>
</header>

    
  <main class="section">
    <div class="container">
      <article class="content">
        <h2 class="title is-2">A feature list for Stencila Sheets</h2>
        <h3 class="is-3">Nokome Bentley, 20 August 2017</h3>
        <p><a href="https://community.stenci.la/u/michael">Michael</a>, <a href="https://community.stenci.la/u/oliver">Oliver</a> and I have been planning the next six months of development and user testing on Stencila Sheets. We&apos;re keen to get input from the community on which features should put in, and which we should leave out, and the relative priority for each.</p>
<p>The plan is to implement initial versions of these features over the coming months, ready for a first round of user testing in early November. Based on that feedback, we&apos;ll know which features need more work, and potentially, which features should be dropped.</p>
<p>For background on Stencila Sheets check out last year&apos;s blog posts:</p>
<ul>
<li><a href="/blog/introducing-sheets/">Spreadsheets are dead, long live reactive programming environments!</a> - an overview and rationale</li>
<li><a href="/blog/underneath-sheets">Getting under Stencila sheets</a> - more technical details</li>
</ul>
<p>We&apos;ll link to some relevant Github issues below. We&apos;d love any comments either on those specific issues, or right here in this forum topic!</p>
<h1 id="1-conventional-spreadsheet-features-that-stencila-sheets-wont-have">-1. Conventional spreadsheet features that Stencila Sheets won&apos;t have!</h1>
<blockquote>
<p>&quot;Knowing what to leave out is just as important as knowing what to focus on.&quot; - Warren Buffet</p>
</blockquote>
<p>One of the fundamental principles of Stencila Sheets is to provide users an environment for conducting reproducible research within a interface that they are already familiar with - the spreadsheet. But we&apos;re not just trying to create an open-source version of Excel - that already in exists e.g. LibreOffice Calc.</p>
<p>We want to create spreadsheet software that is built from the ground up for reproducibility and which addresses some of the shortcomings of using spreadsheets for data analysis. Part of that process is taking the great things about spreadsheets (e.g. a reactive programming environment) and leaving behind the things that lead to errors. That&apos;s why this section is numbered <code>-1</code>.</p>
<p>We want to make Stencila Sheets more semantic and data-centric and less layout and formatting centric. So, some spreadsheet formatting features you won&apos;t see in Stencila Sheets include:</p>
<ul>
<li>font face and font size menu items</li>
<li>text and background colour menu items</li>
<li>cell border style, colour and width</li>
</ul>
<p>By not allowing ad hoc formatting of cells we hope to focus the user on the types and structure of data and formulae in the Sheet. It also allows us to use styling attributes to visually distinguish different types of data and cell types. We do plan to have a conditional formatting feature but this will be very much data-driven (see below).</p>
<h1 id="0-conventional-spreadsheet-features-that-stencila-sheets-will-have">0. Conventional spreadsheet features that Stencila Sheets will have!</h1>
<p>Continuing with our section numbering scheme, this section is numbered <code>0</code> because it&apos;s about implementing the basic interactions and functionality that users expect in a spreadsheet. There is of course a long, long list of spreadsheet features but initially we&apos;re focused on the basics of creating, updating, selecting and deleting cells and entering data and formulae. Over time we&apos;ll be adding more of the advanced features that users expect from spreadsheets (e.g. plotting).</p>
<p><a href="https://community.stenci.la/u/oliver">Oliver</a> and <a href="https://community.stenci.la/u/michael">Michael</a> have already made good progress on this. Check out the <a href="https://github.com/stencila/stencila/pull/326">screenshots</a> - it&apos;s basic functionality, but foundational to establishing a user interface that users are already familiar with! And there&apos;s a lot of thought gone into making it these foundational interactions efficient and extensible.</p>
<p>For all of these &quot;conventional&quot; features, we plan on sticking close to existing spreadsheet interface conventions. Microsoft Excel and Google Sheets have had a lot of user interaction research put into them and provide really good examples to follow. Users are already familiar with them and it seems wasteful and unnecessary to reinvent the wheel. Instead, we&apos;ll put that energy into the novel features of Stencila Sheets that we think make them more suitable for reproducible research...</p>
<h1 id="1-harnessing-the-power-of-open-source-languages-for-scientific-computing">1. Harnessing the power of open-source languages for scientific computing</h1>
<h2 id="1a-allowing-users-to-use-cell-expressions-in-external-languages">1a. Allowing users to use cell expressions in external languages</h2>
<p>The initial idea that sparked Stencila Sheets was to take the model of the computational notebook - code cells embedded within a document - and apply it to the spreadsheet interface. Here&apos;s an example of the first prototype of Stencila Sheets with cell expressions written in R:</p>
<p><img src="sheets-r.gif" alt="Stencila Sheets using R in cells" style="width: 300px;"></p>
<p>We have overhauled the architecture of Stencila so that there is greater decoupling between the user interfaces and the code execution contexts. We also have a useful abstraction layer for passing data between execution contexts. These changes now allow us to have Sheets with cells in a variety of languages.</p>
<p>To allow cell expressions to be written in external languages such as R will require us to revisit our approach to processing of expressions to expand out cell ranges such as <code>A1:A10</code>. For more details, see <a href="https://github.com/stencila/stencila/issues/334">this GitHub issue</a>.</p>
<p>A more advanced but potentially powerful feature related to external languages is &quot;projecting&quot; tabular data values onto the Sheet. For example, one group of columns might be generated by an SQL expression which extracts data from a database, another cell might fit a linear regression model to those data using R. We would need some sort of cell &quot;projection&quot; or &quot;mapping&quot; so that, in this example, if the SQL statement returned tabular data of 10 rows x 5 columns, it would be projected across the 50 adjacent cells. For more details, see <a href="https://github.com/stencila/stencila/issues/118">this GitHub issue</a></p>
<h2 id="1b-allowing-users-to-write-functions-in-external-languages">1b. Allowing users to write functions in external languages</h2>
<p>The other big change in Stencila in the last year is the introduction of Mini. Mini, as it&apos;s name suggests, is a small, simple, purely functional language similar to Excel&apos;s cell formula language.</p>
<p>Mini will allow users to define functions using external languages. This allows more complex code that does not easily fit into a cell to be edited and promotes resusability. It allows users to quickly wrap powerful functionality available in other languages and makes them accessible to other Stencila users. For example a Mini <code>lasso</code> function for Lasso Regression could be written using R&apos;s <code>glmnet</code> package.</p>
<p>As one reader of our initial blog post suggested:</p>
<blockquote>
<p>Functions should not &#x2018;live&#x2019; in cells. Function definitions should simply be part of the spreadsheet&#x2019;s code. The text-representation of the sheet would include not only a series of cell definitions (coordinates of cells and their contents) but proper functions as well. - https://thoughtstreams.io/joeld/problems-with-excel/10205/</p>
</blockquote>
<p>It&apos;s an idea <a href="https://community.stenci.la/u/michael">Michael</a> expanded on <a href="https://medium.com/@_mql/reproducible-science-for-people-who-dont-code-5850abe806db">in his post</a>.</p>
<p>For a discussion of implementation of this, see <a href="https://github.com/stencila/stencila/issues/310">this issue</a></p>
<h1 id="2-strong-typing-of-cells-columns-and-rows">2. Strong typing of cells, columns and rows</h1>
<p>One of the biggest problems with most spreadsheet implementations is &quot;weak typing&quot; - cells can contain any <em>type</em> of value. This combined with auto-conversion can lead to problems like the recently publicized <a href="https://www.washingtonpost.com/news/wonk/wp/2016/08/26/an-alarming-number-of-scientific-papers-contain-excel-errors/?utm_term=.57fd60e354bd">corruption of gene data</a>.</p>
<p>One of the great ideas that <a href="https://community.stenci.la/u/oliver">Oliver</a> has come up with recently is adding strong typing to Sheets. Users could specify that a column, row, cell range or cell was of a particular type (e.g. <code>date</code>, <code>string</code>). If data was entered into the cell, or a cell formula returned a value, which did not conform to the specified type the cell would show an error. Cells with specified types could be visually distinguished (e.g. by colour, or small icon in the corner).</p>
<p>Strong typing would be optional but could be encouraged by providing users with a metric of the proportion of cells that were strongly typed as an indication of the sheet&apos;s &quot;robustness&quot;.</p>
<h1 id="3-distinguish-between-static-and-dynamic-cells">3. Distinguish between static and dynamic cells</h1>
<p>Distinguishing between cells that are static (a.k.a constant, data) and those that are dynamic (i.e. cells starting with an <code>=</code> sign, a.k.a. expressions, formulae) could also reduce the error rate of spreadsheets by clearly separating data from code. Again, this could be done by using colours or icons (the first prototype used a small equals sign in the top left).</p>
<h1 id="4-naming-cells-columns-and-rows">4. Naming cells, columns and rows</h1>
<p>Named cells and cell ranges is a feature available in Excel. It makes cell expressions more readable and less error prone. We want to extend this approach to the ability to name entire columns (and possibly rows). When combined with strong typing this would allow for sheets to be used to edit well defined tabular data, for example, conforming to the Frictionless Data <a href="http://specs.frictionlessdata.io/tabular-data-package/">Tabular Data Specification</a>.</p>
<h1 id="5-clone-cells">5. Clone cells</h1>
<p>One of the biggest sources of errors with spreadsheets is when cell formulae are copy and pasted, or dragged into adjacent cells. Software like Excel will create copies of the formula with cell references updated, so that for example if cell <code>B1</code> has the formula <code>=A1*2</code>, when it is copied into cell <code>B2</code> the formula is updated to <code>=A2*2</code>. That&apos;s great until you want to change the formula, then you have to remember to update all the copies as well - that can be error prone.</p>
<p>To solve that problem Ern&#x151; Zalka suggested the <a href="https://github.com/stencila/stencila/issues/170">idea of &quot;shadow&quot; or &quot;clone&quot; cells</a>.</p>
<h1 id="6-test-cells">6. Test cells</h1>
<p>One often cited criticism of spreadsheets is that they are not testable. In our initial blog posts on Stencila Sheets we discussed how it is fairly straightforward to introduce testing to spreadsheets by allow cells to be marked as &quot;test&quot; cells.</p>
<p>These cells would have an expression which represented a test assertion e.g. <code>= B1 &gt;= 0 &amp;&amp; B1 &lt;= 100</code> to test that the percentage calculated in cell B1 is valid. In our initial prototype we indicated test cells using a <code>?</code> mark and a tick or cross for pass/fail:</p>
<p><img src="sheet-test-cell.png" alt="Stencila Sheets test cells" style="width: 300px;"></p>
<p>We also were able to generate test coverage statistics for the sheet.</p>
<h1 id="7-conditional-formatting">7. Conditional formatting</h1>
<p>Although we want to make Stencila Sheets more semantic we think there is potential value in data-driven, conditional formatting. Conditional formatting can allow easy identification of outlier data and out-of-expected-bounds expression values. It is in effect a form of data visualization.</p>
<p>Conditional formatting would not allow users to arbitrarily format cells. Instead they would need to specify a set of mappings (or &quot;rules&quot;, or &quot;encodings&quot;) between a cells value and it&apos;s style (probably a restricted set of styling attributes e.g background colour, text colour, text weight).
For more details, see <a href="https://github.com/stencila/stencila/issues/97">this GitHub issue</a>.</p>
<h1 id="over-to-you">Over to you!</h1>
<p>Please give us your suggestions! It&apos;s your chance to have a say on where Stencila Sheets is heading. Tell us which of these features you think are most important, which are unnecessary, and which need changing.</p>
<p>To help us prioritize, <strong>vote for the seven features that you think should be the highest priority</strong> (leaving two out). And reply to this post to give us your additional thoughts!</p>
<ul>
<li>1a Allowing users to write cell expressions in external languages</li>
<li>1b Allowing users to write functions in external languages</li>
<li>2 Strong typing of cells, columns and rows</li>
<li>3 Distinguish between static and dynamic cells</li>
<li>4 Naming cells, columns and rows</li>
<li>5 Clone cells</li>
<li>6 Test cells</li>
<li>7 Conditional formatting</li>
<li>8 Constraints (see below)</li>
</ul>
<p>To vote please visit <a href="https://community.stenci.la/t/a-feature-list-for-stencila-sheets/57">this post on our community forum</a>.</p>

      </article>
      
      <div id="discourse-comments">
      </div>
    </div>
  </main>

    <footer class="footer">
  <div class="container">
    <div class="columns">
      <div class="column">
        <h4 class="title is-6 has-text-grey-light"> About </h4>
        <a href="/use">Use </a> <br>
        <a href="/learn"> Learn </a> <br>
        <a href=""> FAQ  </a>  <br>
      </div>
      <div class="column">
        <h4 class="title is-6 has-text-grey-light"> Community </h4>
        <a href="/contribute"> Contribute </a> <br>
        <a href="/community/beta-testing.html"> Beta Testing </a> <br>
        <a href="/community/resources.html"> Resources  </a>  <br>
        <a href="/blog"> Blog  </a>  <br>
      </div>
      <div class="column">
        <h4 class="title is-6 has-text-grey-light"> Contact </h4>
        <a href="mailto:hello@stenci.la">Email </a> <br>
        <a href="https://twitter.com/stencila"> Twitter </a> <br>
        <a href="https://gitter.im/stencila/stencila"> Gitter  </a>  <br>
        <a href="https://community.stenci.la/"> Forum  </a>  <br>
        <a id="edit-page" class="button" href="https://github.com/stencila/website/edit/master/src/blog/2017-08-features-stencila-sheets/index.md" target="_blank" title="Edit this page">&#x270E; Edit</a>
      </div>
    </div>
    <div class="columns">
      <div class="column has-text-grey-light has-text-centered">
          &#xA9; 2018 Stencila <a href="https://github.com/stencila/website/graphs/contributors">contributors</a>
      </div>
   </div>
  </div>
</footer>

  
  
  
  <script type="text/javascript" src="/js/docsearch.min.js"></script>
  <script type="text/javascript" src="/js/website.js"></script>
  

  <script type="text/javascript" src="/js/prism.js"></script>
  <script type="text/javascript" src="/js/prism-bash.min.js"></script>
  <script type="text/javascript" src="/js/prism-json.min.js"></script>
  <script type="text/javascript" src="/js/prism-markdown.min.js"></script>
  <script type="text/javascript" src="/js/prism-mini.js"></script>
  <script type="text/javascript" src="/js/prism-python.min.js"></script>
  <script type="text/javascript" src="/js/prism-r.min.js"></script>
  <script type="text/javascript" src="/js/prism-sql.min.js"></script>

  <script type="text/javascript">
    DiscourseEmbed = {
      discourseUrl: 'https://community.stenci.la/',
      discourseEmbedUrl: window.location.href,
      topicId: 57
    };
    (function() {
      var d = document.createElement('script'); d.type = 'text/javascript'; d.async = true;
      d.src = DiscourseEmbed.discourseUrl + 'javascripts/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(d);
    })();
  </script>


</body></html>